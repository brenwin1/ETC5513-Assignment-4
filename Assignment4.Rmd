---
title: "Corona Virus Report"
author:
- familyname: XXXX
  othernames: XXX
  address: Monash Universtidy
  email: XXX
  correspondingauthor: true
  qualifications:  XXX
- familyname: XXXX
  othernames: Reports
  address: XXX
  qualifications: XXX
- familyname: XXX
  othernames: XXX
  address: XXX
  email: XXX
  correspondingauthor: true
  qualifications:  XXX
department: Our consultancy \newline add names &\newline add names
organization: Australian Government COVID19
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: true
---

Analysis of Crime in Minneapolis:

* What types of crimes are most common?
* What crime is committed by each race? Are they proportionate?
* What are the most common force types?
* Which months of the year have the most criminal records?
* Which day of the week has the most crimes or forces used by police?
* Which area has the most crime?
* Is it the same police committing each crime?



```{r setup}
knitr::opts_chunk$set(echo = FALSE, 
                      cache=TRUE, 
                      messages=FALSE,
                      warning=FALSE)
```

```{r libraries, include = FALSE}
library(tidyverse)
library(rgdal)
library(lubridate)
library(ggrepel)
library(scales)
library(gridExtra)
library(kableExtra)
library(lubridate)
library(ggpubr)
library(RColorBrewer)
```

```{r, include = FALSE}
## Introduction

George Floyd was arrested and killed by Derek Chauvin, a U.S. police officer, on the 25th of May in Minneapolis, @BBC-News-2020. Chauvin knelt on George Floyd’s neck for eight minutes and 46 seconds as Floyd gasped for air.  His abominable death has sparked outrage on police brutality across America.

For several years, African-Americans have been the subject of racial vilification. In a study by @Dottolo-2008 students were interviewed and asked about police harassment and crime. Close analysis revealed that the students had stereotyped the criminals to be poor African American men. Another study by … revealed

This paper hopes to explore and understand crime in Minneapolis. Specifically, the areas where crime is most common, the ethnicity of those committing the crime, and the force used by police. 

```{r crime-incident-data}
crime_incidents <- read_csv("data/Police_Incidents_Last_2Years.csv") 

glimpse(crime_incidents)
```

```{r shapefiles-data}
shp <- rgdal::readOGR(dsn = file.path(paste(getwd(),"/data/Police_Incidents_Last_2Years-shp", sep=""), layer = "Police_Incidents_Last_2Years.shp") , stringsAsFactors = FALSE)

summary(shp@data)
```

```{r police-force-data}
police_use_of_force <- read_csv("data/Police_Use_of_Force.csv")
```

```{r police-stop-data, eval = FALSE}
police_stop_data <- read_csv("data/Police_Stop_Data.csv")
```


## Data

To perform this analysis 


## Methodology 


#### Analysing the crime which is most common 

The crime incidence data was wrangled. This involved assigning each crime to its relevant offence type. The incidence of each offense was calculated, and plotted according to year.


#### Analysing the crime being committed by each race
number_crimes


#### Computing the most common force type


The police use of force data was wrangled, and a summary was generated to count the incidence of each offense according to race. The data was plotted. 

#### Analysing the months of the year which have the most criminal records

#### Analysing the areas that have the most crime 

#### Analysing whether Police are repeat offenders?


# Results

Figure \@ref(fig:plot-number-crimes) demonstrates that across all years, theft is the most commonly committed crime in Minneapolis. In this instance theft includes; automobile theft, bike theft, coin-operated device theft, gas-station drive off, online theft, petty theft, pocket picking, scrapping-recycling theft, theft from a building, theft from a motor vehicle, theft from a person, other theft, theft by swindle and theft of motor vehicle parts. 

```{r clean-crime}
clean_crime <- crime_incidents %>%
  mutate(offense = case_when(
    offense %in% c("ARSON") ~ "Arson",
    offense %in% c("ASLT1",
                   "ASLT2",
                   "ASLT3",
                   "ASLT4") ~ "Assault",
    # Combining automobile theft, bike theft, coin-operated device theft, gas-station drive off, online theft, petty theft, pocket picking, scrapping-recycling theft, theft from a building, theft from a motor vehicle, theft from a person, other theft, theft by swindle, theft of motor vehicle parts
    offense %in% c("AUTOTH",
                   "MVTHFT",
                   "BIKETF",
                   "COINOP",
                   "NOPAY",
                   "ONLTHT",
                   "PETIT",
                   "POCKET",
                   "SCRAP",
                   "TBLDG",
                   "TFMV",
                   "TFPER",
                   "THEFT",
                   "THFTSW",
                   "TMVP") ~ "Theft",
    # Combining burglary of business and burglary of dwelling
    offense %in% c("BURGB",
                   "BURGD") ~ "Burglary",
    offense %in% c("ROBBIZ",
                   "ROBPAG",
                   "ROBPER") ~ "Robbery",
    offense %in% c("SHOPLF") ~ "Shoplifting",
    offense %in% c("COMPUT") ~ "Computer Hacking",
    offense %in% c("CSCR") ~ "Rape",
    # Combing first, second and third degree domestic assult with domestic assault strangulation
    offense %in% c("DASLT1",
                   "DASLT2",
                   "DASLT3",
                   "DASTR") ~ "Domestic Assault",
    offense %in% c("DISARM") ~ "Disarm a police officer",
    offense %in% c("LOOT") ~ "Looting",
    offense %in% c("MURDR") ~ "Murder")) %>%
  mutate(Year = year(enteredDate))
```

```{r number-crimes}
number_crimes <- clean_crime %>%
  group_by(offense,
           Year) %>%
  summarise(Incidence = n())
```

```{r plot-number-crimes}
ggplot(number_crimes,
       aes(x = offense,
           y = Incidence,
           group = Year)) +
  geom_col() +
  facet_wrap(~Year) +
  xlab("Type of Offense") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

According to Figure \@ref(fig:bar-chart-force) the most common force used is Bodily Force, then Chemical Irritant and taser.


```{r police-force-clean}
police_use_of_force_count <- police_use_of_force %>%
  filter(ForceType != "NA",
         Race != "NA") %>%
  group_by(ForceType, 
           Race) %>%
  summarise(Count = n()) 
```

```{r bar-chart-force}
ggplot(police_use_of_force_count,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  facet_wrap(~ForceType) 
```



```{r baton-use}
baton_use <- police_use_of_force %>%
  filter(ForceType == "Baton") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r baton-use-plot}
baton_bar <- ggplot(baton_use ,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r baton-use-pie-chart}
baton_pie <- ggplot(baton_use,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r bodily-force}
bodily_force <- police_use_of_force %>%
  filter(ForceType == "Bodily Force") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r bodily-force-use-plot}
bodily_force_bar <- ggplot(bodily_force,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r bodily-force-pie-chart}
bodily_force_pie <- ggplot(bodily_force,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r chemical-irritant}
chemical_irritant <- police_use_of_force %>%
  filter(ForceType == "Chemical Irritant") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r chemical-irritant-use-plot}
chemical_irritant_bar <- ggplot(chemical_irritant,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r chemical_irritant-pie-chart}
chemical_irritant_pie <- ggplot(chemical_irritant,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r firearm}
firearm <- police_use_of_force %>%
  filter(ForceType == "Firearm") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r firearm-use-plot}
firearm_bar <- ggplot(firearm,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r firearm-pie-chart}
firearm_pie <- ggplot(firearm,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r gun-point}
gun_point <- police_use_of_force %>%
  filter(ForceType == "Gun Point Display") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r gun-point-plot}
gun_point_plot <- ggplot(gun_point,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r gun-point-pie-chart}
gun_point_pie <- ggplot(gun_point,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r improvised-weapon}
improvised_weapon <- police_use_of_force %>%
  filter(ForceType == "Improvised Weapon") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r improvised-weapon-plot}
improvised_weapon_plot <- ggplot(improvised_weapon,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r improvised-weapon-pie-chart}
improvised_weapon_pie <- ggplot(improvised_weapon,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r less-lethal}
less_lethal <- police_use_of_force %>%
  filter(ForceType == "Less Lethal") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r less-lethal-plot}
less_lethal_plot <- ggplot(less_lethal,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r less-lethal-pie-chart}
less_lethal_pie <- ggplot(less_lethal,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r less-lethal-projectile}
less_lethal_projectile <- police_use_of_force %>%
  filter(ForceType == "Less Lethal Projectile") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r less-lethal-projectile-plot}
less_lethal_projectile_plot <- ggplot(less_lethal_projectile,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r less-lethal-projectile-pie-chart}
less_lethal_projectile_pie <- ggplot(less_lethal_projectile,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r maximal-restraint-technique}
maximal_restraint_technique <- police_use_of_force %>%
  filter(ForceType == "Maximal Restraint Technique") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r maximal-restraint-technique-plot}
maximal_restraint_technique_plot <- ggplot(maximal_restraint_technique,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r maximal-restraint-technique-pie-chart}
maximal_restraint_technique_pie <- ggplot(maximal_restraint_technique,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r canine-bite}
canine_bite <- police_use_of_force %>%
  filter(ForceType == "Police K9 Bite") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r canine-bite-plot}
canine_bite_plot <- ggplot(canine_bite,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r canine-bite-pie-chart}
canine_bite_pie <- ggplot(canine_bite,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

```{r taser}
taser <- police_use_of_force %>%
  filter(ForceType == "Taser") %>%
  group_by(Race) %>%
  summarise(Count = n())
```

```{r taser-plot}
taser_plot <- ggplot(taser,
       aes(x = Race,
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  xlab("Race") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

```{r taser-pie-chart}
taser_pie <- ggplot(taser,
       aes(x = "",
           y = Count,
           fill = Race)) +
  geom_bar(width = 1, 
           stat = "identity") +
  coord_polar("y",
              start = 0)
```

Figure \@ref(fig:arrange-pie) captures how the police have used force on each race. Baton, bodily force, chemical irritant, firearm, gun point, improvised weapon, canine bite and taser are all used on African Americans most frequently. Interestingly enough, less lethal force is used on white people the most, proportionately. In addition, less lethal projectiles and maximal restraint technique are most commonly used on white and asian people. 

Therefore, assuming that crime being committed by African-Americans is similar in nature to the crime being committed by all other races, it is likely African-Americans are more likely to be subject of ruthless force use. 

```{r arrange-bar, fig.dim=c(15,15)}
ggarrange(baton_bar,
          bodily_force_bar,
          chemical_irritant_bar,
          firearm_bar,
          gun_point_plot,
          improvised_weapon_plot,
          less_lethal_plot,
          less_lethal_projectile_plot,
          maximal_restraint_technique_plot,
          canine_bite_plot,
          taser_plot,
          labels = c("Baton",
                     "Bodily Force",
                     "Chemical Irritant",
                     "Firearm",
                     "Gun Point",
                     "Improvised Weapon",
                     "Less Lethal",
                     "Less Lethal Projectile",
                     "Maximal Restraint Technique",
                     "Canine Bite",
                     "Taser"),
          vjust = 0.5,
          hjust = -1.75,
          font.label = list(size = 10),
          legend = c("top"),
          ncol = 3,
          nrow = 4,
          # Create a common legend
          common.legend = TRUE)
```

```{r arrange-pie, fig.dim=c(10,10)}
ggarrange(baton_pie,
          bodily_force_pie,
          chemical_irritant_pie,
          firearm_pie,
          gun_point_pie,
          improvised_weapon_pie,
          less_lethal_pie,
          less_lethal_projectile_pie,
          maximal_restraint_technique_pie,
          canine_bite_pie,
          taser_pie,
          labels = c("Baton",
                     "Bodily Force",
                     "Chemical Irritant",
                     "Firearm",
                     "Gun Point",
                     "Improvised Weapon",
                     "Less Lethal",
                     "Less Lethal Projectile",
                     "Maximal Restraint Technique",
                     "Canine Bite",
                     "Taser"),
          align = "hv",
          vjust = 0.5,
          hjust = -0.5,
          font.label = list(size = 10),
          legend = c("top"),
          ncol = 3,
          nrow = 4,
          # Create a common legend
          common.legend = TRUE)
```

# Conclusion 



# brenwin's section
What; no. different crime offense?
```{r}
crime_incidents %>%
  group_by(offense) %>%
  summarise(unique(offense))
```


# Police use of force data

What; type of police forcetype?
```{r police-use-of-force-clean}
police_use_of_force %>%
  group_by(ForceType) %>%
  summarise(unique(ForceType))
```

number of times; force types used by police
```{r}
police_use_of_force %>% 
  group_by(ForceType) %>% 
  count()
```

what; no. of times force types used against each race
```{r}
police_use_of_force %>% 
  group_by(ForceType, Race) %>% 
  count()
```

No. of incidence; force used; per race
```{r}
police_use_of_force %>% 
  group_by(Race) %>% 
  count()
```



Use of force per race faceted by Force Type
```{r}
use_of_force_bar <- police_use_of_force %>% 
  filter(!is.na(Race),
         ForceType != "Bodily Force") %>% # see other types; many Bodily Force incidence; extend the ylimit; so remove
  ggplot() +
  geom_bar(aes(x = Race)) +
  facet_wrap(~ `ForceType`) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3)) +
  coord_flip()

use_of_force_bar
```

```{r bodily-force-pie-chart}
use_of_force_bar +
  coord_polar()
```


# attempting to do maps with `leaflet`

```{r}
library(leaflet)
library(rgdal)

shp <- rgdal::readOGR(dsn = file.path(paste(getwd(),"/data/Police_Incidents_Last_2Years-shp", sep=""), layer = "Police_Incidents_Last_2Years.shp") , stringsAsFactors = FALSE)

head(shp@data)
summary(shp@data)
head(shp@data)
```

```{r}
library(sf)
# Read shp file into a data frame
shp_sf <- st_read(dsn = file.path(paste(getwd(),"/data/Police_Incidents_Last_2Years-shp/Police_Incidents_Last_2Years.shp", sep=""))) %>% 
  dplyr::filter(centerLat != 0) # delete data (17 rows) where public address not provided
```

```{r}
# make bounding box 
ggmap::make_bbox(lon = shp_sf$centerLong, 
                 lat = shp_sf$centerLat) 

shp_sf %>% 
  leaflet() %>% 
  addTiles() %>% 
  # Add Circle Markers 
  addCircleMarkers(lng = shp_sf$centerLong, 
             lat = shp_sf$centerLat, 
             clusterOptions = markerClusterOptions()) # cluster circles and prevent hanging!


# xxxxx potentially; group and label markers (by race and neighbourhood)
# xxxxx change tile to Google maps (more familiar )
```

What is the ethnicity of those who are commmitting the crimes? 

```{r}
unique(police_use_of_force$Neighborhood)
# 90 neighbourhoods
```
no. of crimes in each group 
```{r number-crimes}
number_crimes <- clean_crime %>%
  group_by(offense) %>%
  summarise(Incidence = n())
number_crimes
```

no. of crimes; past for last 2 years
```{r plot-number-crimes}
ggplot(number_crimes,
       aes(x = offense,
           y = Incidence)) +
  geom_col() +
  xlab("Type of Offense") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
clean_crime
```

# lulupi's section
## the top neighborhood with the most cases in each year

```{r neighborhood2018}
neighborhood_summary <- clean_crime %>% select(precinct,
                                                reportedDate,
                                                neighborhood)
neighborhood_summary$year <- year(neighborhood_summary$reportedDate)

neighborhood_summary2018 <- neighborhood_summary %>%
  dplyr::filter(year %in% c("2018")) %>%
  group_by(neighborhood) %>%
  summarise(case = n()) %>%
  distinct() %>%
  top_n(20)

kable(neighborhood_summary2018, caption = "top 20 neighborhood with most cases in 2018") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


```{r neighborhood2019}
neighborhood_summary2019 <- neighborhood_summary %>%
  dplyr::filter(year %in% c("2019")) %>%
  group_by(neighborhood) %>%
  summarise(case = n()) %>%
  distinct() %>%
  top_n(20)

kable(neighborhood_summary2019, caption = "top 20 neighborhood with most cases in 2019") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r neighborhood2020}
neighborhood_summary2020 <- neighborhood_summary %>%
  dplyr::filter(year %in% c("2020")) %>%
  group_by(neighborhood) %>%
  summarise(case = n()) %>%
  distinct() %>%
  top_n(20)

kable(neighborhood_summary2020, caption = "top 20 neighborhood with most cases in 2020") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r neighborhood2018}
neighborhood_summary2018 %>%
  ggplot(aes(reorder(neighborhood, case), y = case)) +
  geom_col(fill = "red") +
  geom_label_repel(aes(label = case), size = 2.5) +
  coord_flip() +
  labs(title = "top 20 neighborhood with most cases in 2018", 
       x = "neighborhood", 
       y = "case")
```

```{r neighborhood2019}
neighborhood_summary2019 %>%
  ggplot(aes(reorder(neighborhood, case), y = case)) +
  geom_col(fill = "blue") +
  geom_label_repel(aes(label = case), size = 2.5) +
  coord_flip() +
  labs(title = "top 20 neighborhood with most cases in 2019", 
       x = "neighborhood", 
       y = "case")
```

```{r neighborhood2020}
neighborhood_summary2020 %>%
  ggplot(aes(reorder(neighborhood, case), y = case)) +
  geom_col(fill = "green") +
  geom_label_repel(aes(label = case), size = 2.5) +
  coord_flip() +
  labs(title = "top 20 neighborhood with most cases in 2020", 
       x = "neighborhood", 
       y = "case")

```
As in  Figure\@ref(fig:neighborhood2018), Figure\@ref(fig:neighborhood2019) and Figure\@ref(fig:neighborhood2020), **Downtown West** and **Whittier** always be the top areas with the most cases, the following areas would be **Longfellow**, **Lowry Hill East** and **Marcy Holmes** in each year. 


```{r precinct}
precinct_summary <- clean_crime %>% select(precinct,
                                                reportedDate)
precinct_summary$year <- year(precinct_summary$reportedDate)

precinct_summary <- precinct_summary %>%
  dplyr::select(year,
                precinct) %>%
  group_by(year,
                precinct) %>%
  mutate(case = n()) %>%
  unique() %>%
  arrange(-case)

precinct_summary %>% ggplot(aes(x = precinct,
             y = case,
             colour = year)) +
  geom_point() +
  facet_wrap(~ year) +
  xlab("precinct") +
  ylab("case") +
  ggtitle("precinct summary in each year") +
  theme(legend.position = "none")
```

The precinct with the most cases contributed to precinct 3 in three years, as shown in the Figure\@ref(fig:precinct), while the top 2 neigorborhoods located in precinct 1 and 5. There should be more force transferred to the related precinct if it is necessary, and prepare efficient and effective resistance to the neighborhood with most cases as soon as possible. 

## Analyse of police force used
```{r force used for primary offense}
force_used_summary <- police_use_of_force %>% select(PrimaryOffense,
                                                ResponseDate,
                                                ForceType,
                                                SubjectInjury,
                                                TypeOfResistance)
force_used_summary$year <- year(force_used_summary$ResponseDate)

force_used_summary2018 <- force_used_summary %>%
  dplyr::filter(year %in% c("2018")) %>%
  group_by(PrimaryOffense) %>%
  summarise(case = n()) %>%
  distinct() %>%
  head(10)
g1 <- force_used_summary2018 %>% ggplot(aes(x=case, reorder(PrimaryOffense, case))) + 
        geom_bar(stat='identity', fill='red') +
    ggtitle("force used in 2018") +
labs(x='case2018', y='primary offence')

force_used_summary2019 <- force_used_summary %>%
  dplyr::filter(year %in% c("2019")) %>%
  group_by(PrimaryOffense) %>%
  summarise(case = n()) %>%
  distinct() %>%
  head(10)
g2 <- force_used_summary2019 %>% ggplot(aes(x=case, reorder(PrimaryOffense, case))) + 
        geom_bar(stat='identity', fill='blue') +
    ggtitle("force used in 2019") +
labs(x='case2019', y='primary offence')

force_used_summary2020 <- force_used_summary %>%
  dplyr::filter(year %in% c("2020")) %>%
  group_by(PrimaryOffense) %>%
  summarise(case = n()) %>%
  distinct() %>%
  head(10)

g3 <- force_used_summary2020 %>% ggplot(aes(x=case, reorder(PrimaryOffense, case))) + 
        geom_bar(stat='identity', fill='green') +
    ggtitle("force used in 2020") +
labs(x='case2020', y='primary offence')

grid.arrange(g1, g2, g3, ncol = 3)
```

```{r force type}
force_type_used <- force_used_summary %>%
  dplyr::filter(year %in% c("2018",
                            "2019",
                            "2020")) %>%
  group_by(ForceType,
           year) %>%
  summarise(total = n()) %>%
  distinct()

force_type_used %>% ggplot(aes(x=total, reorder(ForceType, total))) + 
        geom_bar(stat='identity') +
    facet_wrap(~ year) +
    ggtitle("force used tpye") +
labs(x='total', y='force type')
```

```{r injury condition}
injury_of_force <- force_used_summary %>%
  dplyr::filter(year %in% c("2018",
                            "2019",
                            "2020")) %>%
  group_by(SubjectInjury,
           year) %>%
  summarise(total = n()) %>%
  distinct()

injury_of_force %>% ggplot(aes(x = SubjectInjury,
             y = total,
             colour = SubjectInjury)) +

          geom_bar(stat='identity', fill="white") +
    facet_wrap(~ year) +
    ggtitle("injury condition") +
labs(x='injury condition', y='total')

```

```{r resistant type}
resistant_summary <- force_used_summary %>%
  dplyr::filter(year %in% c("2018",
                            "2019",
                            "2020")) %>%
  group_by(TypeOfResistance,
           year) %>%
  summarise(case = n()) %>%
  distinct()

resistant_summary %>% ggplot(aes(reorder(TypeOfResistance, case), y=case)) + 
        geom_bar(stat='identity') +
    facet_wrap(~ year) +
    theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
    ggtitle("resistant type") +
labs(x='type of resistance', y='case')
```
The most reason for force used in 2018, 2019 and 2020 is **ASLT4** as shown in Figure\@ref(fig:force used for primary offense), which means the offense is less than substantive harm. The safety of polices when they use of force is need to be paid attention as well. According to Figure\@ref(fig:resistant type), polices would provide resistant mostly with **tensed** cases, typically when people experienced anxiety or nervousness. Chasing crimes with cases when **fled on foot**, or dealing with **assaulted Officers** are the common tasks they faced every day no matter in which year. Therefore, polices would use **bodily force** in more than 70% cases as in Figure\@ref(fig:force type), the following would be using **chemical irritant**, and they actually would use gun in rare cases. However, they still got injured in approximately 52% cases according to the recorded data we have in 2018 and 2019 with Figure\@ref(fig:injury condition), since they take punches, kicks, Body Weight to pin and joint lock, related protection tools should be prepared to them and regularly training as well if possible. 

