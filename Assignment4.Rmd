---
title: "Crime in Minneapolis"
author:
- familyname: Pi
  othernames: Lulu
  address: Monash University
  email: lpi2@student.monash.edu
  correspondingauthor: true
  qualifications: Bachelor of Accounting
- familyname: Sheehan
  othernames: Emily
  address: Monash University
  email: eshe0012@student.monash.edu
  correspondingauthor: true
  qualifications: BCom
- familyname: Ang
  othernames: Brenwin
  address: ang0005@student.monash.edu
  qualifications: BCom
- familyname: Ye
  othernames: Chengzhi
  address: Monash University
  email: cyee0011@student.monash.edu
  correspondingauthor: true
  qualifications: BCom
department: Faculty of \newline Business &\newline Economics
organization: Monash University
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      cache=TRUE, 
                      messages=FALSE,
                      warning=FALSE)
```

```{r libraries}
# load libraries
library(tidyverse)
library(rgdal)
library(ggrepel)
library(scales)
library(gridExtra)
library(kableExtra)
library(lubridate)
library(ggpubr)
library(RColorBrewer)
library(leaflet)
library(knitr)
library(sf)
```

```{r crime-incident-data, include = FALSE}
# crime incidents data
crime_incidents <- read_csv("data/Police_Incidents_Last_2Years.csv") 

# police use of force data
police_use_of_force <- read_csv("data/Police_Use_of_Force.csv")

# police stop data
police_stop_data <- read_csv("data/Police_Stop_Data.csv") %>% 
  filter(!(race %in% c("Unknown"))) %>% 
  filter(!is.na(race))

# demographics data
demographics_raw <- read_csv(here::here("data/minneapolis_demographics/profile_download_file_msp_neighborhoods_2014_2018.csv"))
```

```{r, include = FALSE}
# ----------- Police use of force
# read shp file
puof_shp <- rgdal::readOGR(dsn = file.path(paste(getwd(),"/data/Police_Use_of_Force-shp", sep=""), layer = "Police_Use_of_Force.shp") , stringsAsFactors = FALSE)

puof_sf <- st_read(dsn = file.path(paste(getwd(),"/data/Police_Use_of_Force-shp/Police_Use_of_Force.shp", sep=""))) %>% 
  filter(CenterLati != 0) %>% 
  filter(!(Race %in% c("not recorded", "Unknown")))
```

```{r police-force-data, include = FALSE}
# read police use of force data
police_use_of_force <- read_csv("data/Police_Use_of_Force.csv")
```

```{r clean-crime}
clean_crime <- crime_incidents %>%
  mutate(offense = case_when(
    offense %in% c("ARSON") ~ "Arson",
    offense %in% c("ASLT1",
                   "ASLT2",
                   "ASLT3",
                   "ASLT4") ~ "Assault",
    # Combining automobile theft, bike theft, coin-operated device theft, gas-station drive off, online theft, petty theft, pocket picking, scrapping-recycling theft, theft from a building, theft from a motor vehicle, theft from a person, other theft, theft by swindle, theft of motor vehicle parts
    offense %in% c("AUTOTH",
                   "MVTHFT",
                   "BIKETF",
                   "COINOP",
                   "NOPAY",
                   "ONLTHT",
                   "PETIT",
                   "POCKET",
                   "SCRAP",
                   "TBLDG",
                   "TFMV",
                   "TFPER",
                   "THEFT",
                   "THFTSW",
                   "TMVP") ~ "Theft",
    # Combining burglary of business and burglary of dwelling
    offense %in% c("BURGB",
                   "BURGD") ~ "Burglary",
    offense %in% c("ROBBIZ",
                   "ROBPAG",
                   "ROBPER") ~ "Robbery",
    offense %in% c("SHOPLF") ~ "Shoplifting",
    offense %in% c("COMPUT") ~ "Computer Hacking",
    offense %in% c("CSCR") ~ "Rape",
    # Combing first, second and third degree domestic assult with domestic assault strangulation
    offense %in% c("DASLT1",
                   "DASLT2",
                   "DASLT3",
                   "DASTR") ~ "Domestic Assault",
    offense %in% c("DISARM") ~ "Disarm a police officer",
    offense %in% c("LOOT") ~ "Looting",
    offense %in% c("MURDR") ~ "Murder")) %>%
  mutate(Year = year(enteredDate))
```

```{r cleaning data}
# prepare crime data for analysis
crime_MPLS_selected <- clean_crime %>% 
  select(reportedDate, offense, neighborhood, precinct, X, Y, description)
crime_MPLS_selected$year <- year(crime_MPLS_selected$reportedDate)
crime_MPLS_selected$month <- month(crime_MPLS_selected$reportedDate)
crime_MPLS_selected$days <- day(crime_MPLS_selected$reportedDate)

police_force_selected <- police_use_of_force %>% 
  select(ResponseDate, Problem, PrimaryOffense, ForceType, Race, Sex, TypeOfResistance ,Precinct,Neighborhood) 


police_force_selected$year <- year(police_force_selected$ResponseDate)
police_force_selected$month <- month(police_force_selected$ResponseDate)
police_force_selected$days <- day(police_force_selected$ResponseDate)

police_force_2018 <- police_force_selected %>% 
  filter(year %in% c("2018","2019", "2020"))
```

\clearpage

# Introduction

George Floyd was arrested and killed by Derek Chauvin, a U.S. police officer, on the 25th of May in Minneapolis, @BBC-News-2020. Chauvin knelt on George Floydâ€™s neck for eight minutes and 46 seconds as Floyd gasped for air.  His abominable death has sparked outrage on police brutality across America. 

For several years, African-Americans have been the subject of racial vilification. In a study by @Dottolo-2008 students were interviewed and asked about police harassment and crime. Close analysis revealed that the students had stereotyped the criminals to be poor African American men.

This paper hopes to explore and understand crime in Minneapolis. Specifically, the crime incidence, the neighborhoods where crime is most common, the crime incidence over time, the force used by police and the areas where police have used force. 

# Data

To perform this analysis data was downloaded from the City of @Minneapolis-2020. The data obtained included the shapefiles, the crime dashboard (crime incident data) and the use of force dashboard (the use of force data). 

The crime incident data had a high number of missing values, where the race of the offender was not recorded. To mitigate the impact on the calculated proportions, particularly where race is concerned, they were not removed. This considered, the analysis will be impacted and the resulting proportions may be under-estimated as a result of the missing values. 

The use of force data has a high number of missing values which will adversely impact the accuracy of the analysis. In addition, there is a Precinct 0 and there is no explanation on the official Minneapolis website which will certainly impact the results. The 'ResponseDate' can be traced back to 2008, however, no records have been kept, therefore it cannot be used in analysis. Finally, the 'PoliceUseOfForceID' and 'OBJECTID' cannot be used for analysis as they are arranged in order and are independent of 'real' police officers and 'real' witnesses. While it protects the privacy of these individuals, it means that conclusions on aggressive police officers cannot be drawn. 

\clearpage
# Methodology 

## Analysing the Crime Incidence

The crime incident data was wrangled, and each offense was assigned to its relevant offense type. Each offense was grouped according to year, and the incidence of each offense was calculated. The results were plotted in Figure \@ref(fig:plot-number-crimes).

## Analysing the Neighborhoods with the Most Crime

To create Figure \@ref(fig:offencetype), the top ten neighborhoods with the highest crime rate were plotted, and then filled according to offense.

To create Figure \@ref(fig:neighborhood2018), Figure \@ref(fig:neighborhood2019) and Figure \@ref(fig:neighborhood2020), the crime incident data was cleaned, using lubridate package. It was filtered for year and grouped by neighborhood. The incidence was counted, and the top 20 neighborhoods were plotted and tabulated for each year. 

For Figure \@ref(fig:Crimeanalysis), all precincts were plotted and filled according to offense. 

## Analysing the Crime over Time

The crime incident data was filtered and grouped according to year, and crime was counted for each month. The results were plotted in Figure \@ref(fig:timefig). 

## Analysing the Force Used by Police

To create Figure \@ref(fig:weekdaysituation), incidence for crime and force used was counted according to weekday.

The use of force data was filtered for type of resistance. The results were plotted in Figure \@ref(fig:TypeOfResistance). Each resistance band was filled according to Precinct. 

To create Figure \@ref(fig:relationshipfig) the use of force data was filtered for type of resistance. The results were plotted and each force type band was filled according to resistance type. 

The use of force data was filtered for race. The results were plotted in Figure \@ref(fig:Race) and each force type band was filled according to race. 

## Mapping the Data

The shape files were downloaded from Open Minneapolis, an open data repository containing spatial geographic information on Minneapolis. The shape files were used to map the neighbourhood outlines, plot the police use of force and stop data circle points, @neighbourhood.

The data was wrangled and joined with the demographics information retrieved from @mncompass. The information included estimates of the 5-year average neighbourhood population, collected in the 2014-2018 American Community survey. The estimates were adjusted according to the Census neighbourhood boundaries, which means that each neighbourhood could be filled according to the proportion of African Americans residing there.

\clearpage
# Results

## Crime Incidence 

Figure \@ref(fig:plot-number-crimes) demonstrates that across all years, theft is the most commonly committed crime in Minneapolis. Burglary and assault are the second and third highest committed crimes, respectively. It should be noted that 2019 is the only complete year, hence the higher incidence. 

```{r number-crimes, warning = FALSE, message = FALSE}
number_crimes <- clean_crime %>%
  # group by offense and year
  group_by(offense,
           Year) %>%
  # calculate crime incidence 
  summarise(Incidence = n())
```

```{r plot-number-crimes, fig.cap= "Crime incidence according to Year and Offense Type"}
ggplot(number_crimes,
       aes(x = offense,
           y = Incidence,
           group = Year,
           # colour the plot according to offense
           fill = offense)) +
  geom_col() +
  # colour using the viridis package
  scale_fill_ordinal() +
  # split the plots according to year
  facet_wrap(~Year) +
  xlab("Type of Offense") +
  # rotate the text to enhance readability of the plot
  theme(axis.text.x = element_text(angle = 90, vjust = 0.3))
```

## Neighborhoods with the Most Crimes

Figure \@ref(fig:offencetype) captures the top five most frequently committed offenses in the neighborhoods with the highest crime rates. It is clear that theft is the most commonly committed crime across all neighborhoods, consistent with Figure \@ref(fig:plot-number-crimes). Comparatively, Longflow has a similar incidence of shoplifting and theft. 

```{r offencetype, fig.dim = c(6,4), fig.align="center", fig.cap="The most common offence type in the Neighborhoods with the highest Crime Incidence"}
crime_MPLS_selected %>% 
  filter(neighborhood %in% (crime_MPLS_selected  %>% count(neighborhood) %>% arrange(-n) %>% head(10) %>% pull(neighborhood)),
  offense %in% (crime_MPLS_selected  %>% count(offense) %>% arrange(-n) %>% head(5) %>% pull(offense))) %>% 
    ggplot(aes(neighborhood, fill = offense))+
    geom_bar(position = "fill")+
    scale_fill_ordinal()+
    coord_flip()
```

```{r neighborhood-2018, include=FALSE}
neighborhood_summary <- clean_crime %>% select(precinct,
                                                reportedDate,
                                                neighborhood)
neighborhood_summary$year <- year(neighborhood_summary$reportedDate)


neighborhood_summary2018 <- neighborhood_summary %>%
  dplyr::filter(year %in% c("2018")) %>%
  group_by(neighborhood) %>%
  summarise(case = n()) %>%
  distinct() %>%
  top_n(20)
```

```{r neighborhood-2018-table}
kable(neighborhood_summary2018, caption = "Top 20 Neighborhoods with the Highest Crime Rate for 2018") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r neighborhood-2019, include=FALSE}
neighborhood_summary2019 <- neighborhood_summary %>%
  dplyr::filter(year %in% c("2019")) %>%
  group_by(neighborhood) %>%
  summarise(case = n()) %>%
  distinct() %>%
  top_n(20)
```

```{r neighborhood-2019-table}
kable(neighborhood_summary2019, caption = "Top 20 Neighborhoods with the Highest Crime Rate for 2019") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```


```{r neighborhood-2020, include=FALSE}
neighborhood_summary2020 <- neighborhood_summary %>%
  dplyr::filter(year %in% c("2020")) %>%
  group_by(neighborhood) %>%
  summarise(case = n()) %>%
  distinct() %>%
  top_n(20)
```

```{r neighborhood-2020-table}
kable(neighborhood_summary2020, caption = "Top 20 Neighborhoods with the Highest Crime Rate for 2020") %>%
  kable_styling(bootstrap_options = c("striped", "hover"))
```

```{r neighborhood2018, fig.dim = c(6,4), fig.cap= "Top 20 Neighborhoods with the Highest Crime Rate for 2018"}
neighborhood_summary2018 %>%
  ggplot(aes(reorder(neighborhood, case), y = case)) +
  geom_col(fill = "yellow") +
  geom_label_repel(aes(label = case), size = 2.5) +
  coord_flip() +
  labs(x = "Neighborhood", 
       y = "Incidence")
```

```{r neighborhood2019, fig.dim = c(6,4), fig.cap = "Top 20 Neighborhoods with the Highest Crime Rate for 2019"}
neighborhood_summary2019 %>%
  ggplot(aes(reorder(neighborhood, case), y = case)) +
  geom_col(fill = "midnight blue") +
  geom_label_repel(aes(label = case), size = 2.5) +
  coord_flip() +
  labs(x = "Neighborhood", 
       y = "Incidence")
```

```{r neighborhood2020, fig.dim = c(6,4), fig.cap = "Top 20 Neighborhoods with the Highest Crime Rate for 2020"}
neighborhood_summary2020 %>%
  ggplot(aes(reorder(neighborhood, case), y = case)) +
  geom_col(fill = "light green") +
  geom_label_repel(aes(label = case), size = 2.5) +
  coord_flip() +
  labs(x = "Neighborhood", 
       y = "Incidence")
```

Figure \@ref(fig:neighborhood2018), Figure \@ref(fig:neighborhood2019) and Figure \@ref(fig:neighborhood2020), show that across all years **Downtown West** and **Whittier** have the highest crime rate, followed by **Longfellow**, **Lowry Hill East** and **Marcy Holmes**. 

Figure \@ref(fig:Crimeanalysis) explores the relationship between precinct and offense type. Across all precincts, theft is the most commonly committed crime, consistent with Figure \@ref(fig:plot-number-crimes). Interestingly enough, precinct 1 and 2 have a similar incidence of theft, however, precinct 5 has a much higher incidence of burglary. 

```{r Crimeanalysis, fig.align="center", fig.width= 8, fig.cap="Crimes comparison of different districts"}
crime_MPLS_selected %>% filter(offense %in% 
                                 (crime_MPLS_selected 
                                  %>% count(offense) %>%
                                  arrange(-n) %>%
                                  # use top ten offenses only
                                  head(10) 
                                  %>% pull(offense))) %>% 
    ggplot(aes(precinct, 
               fill = offense))+
    geom_bar()+
  # swap the x and y axis
    coord_flip()+
   # colour using the viridis package
    scale_fill_ordinal()
```

## Crime over Time 

Figure \@ref(fig:timefig) compares the incidence of crimes in each month. As stated above, 2019 is the only complete year in the data set. In 2018, crime peaked in October, and dropped in December. In 2019, crime was very low in the colder months (January, February and March), peaking in the summer months (July and August). Comparatively, the incidence of crime in 2020 was much lower than 2019 and did not increase in May, which is likely due to the stay at home orders resulting from COVID-19. 

```{r timefig, fig.align="center", fig.width= 8, fig.cap="Comparison of crimes in different months"}
crime_MPLS_month_2018 <- crime_MPLS_selected %>%
  # filter according to year
  filter(year == 2018) %>% 
  select(year, month) %>% 
  # group by year
  group_by(year) %>% 
  count(month) 
p1 <-   ggplot(crime_MPLS_month_2018, 
        aes(x=as.factor(month), y=n)) + 
  # fill with red
        geom_bar(stat='identity', fill="light green") +
        scale_y_continuous(labels=comma, limits = c(0, 2000)) + 
  # facet according to year
        facet_grid(.~year) + 
  # label x and y axis
        labs(x='Month', y='Number of incidents')

crime_MPLS_month_2019 <- crime_MPLS_selected %>%
  # filter according to year
  filter(year == 2019) %>% 
  select(year, month) %>% 
  # group by year
  group_by(year) %>% 
  count(month) 
p2 <-   ggplot(crime_MPLS_month_2019, 
        aes(x=as.factor(month), y=n)) + 
  # fill with red
        geom_bar(stat='identity', fill="light green") +
        scale_y_continuous(labels=comma) + 
  # facet according to year
        facet_grid(.~year) + 
  # label x and y axis
        labs(x='Month', y='Number of incidents')

crime_MPLS_month_2020 <- crime_MPLS_selected %>%
  # filter according to year
  filter(year == 2020) %>% 
  select(year, month) %>%
  # group by year
  group_by(year) %>% 
  count(month) 
p3 <-  ggplot(crime_MPLS_month_2020, 
          aes(x=as.factor(month), y=n)) + 
  # fill with red
          geom_bar(stat='identity', fill="light green") +
          scale_y_continuous(labels=comma, limits = c(0, 2000)) + 
  # facet according to year
          facet_grid(.~year) + 
  # label x and y axis
          labs(x='Month', y='Number of incidents')

# arrange the plots so they are displayed as one plot
grid.arrange(p1, p2, p3, ncol = 3)
```

## Force Used by Police Data

Figure \@ref(fig:weekdaysituation) shows the distribution of the total crimes and force used over the week. There are more crimes on weekdays than on weekends, however, there is greater force use on weekends. It is likely that entertainment venues draw large crowds on the weekends, therefore attracting a large police presence. Furthermore, it is unlikely criminals will commit crimes, particularly when police presence is so high. 

```{r weekdaysituation, fig.align="center", fig.width= 8, fig.cap="The average crimes and force used in a given week"}
crime_MPLS_selected$weekday <- wday(crime_MPLS_selected$reportedDate, label=TRUE)
police_force_2018$weekday <- wday(police_force_2018$ResponseDate, label=TRUE)

w1 <- crime_MPLS_selected %>% 
        count(weekday) %>%
          ggplot(aes(x=weekday, y=n)) + 
          geom_bar(stat='identity', fill="midnight blue") +
          scale_y_continuous(labels=comma) +
          labs(x='Weekday', y='Number of Crimes', title='Daily Crime Incidence')

w2 <- police_force_2018 %>% 
        count(weekday) %>%
          ggplot(aes(x=weekday, y=n)) + 
          geom_bar(stat='identity', fill="yellow") +
          scale_y_continuous(labels=comma) +
          labs(x='Weekday', y='Incidence of Force Use', title='Daily Force Use')

grid.arrange(w1, w2, ncol = 2)
```

Figure \@ref(fig:TypeOfResistance) shows the resistance used in each precinct. In essence, this figure captures the prevalence of crime and the efficiency of police in controlling the crime rate. It can be inferred that the fourth precinct is significantly more dangerous than the fifth precinct, and the force use in the fourth precinct is much higher. 

```{r TypeOfResistance, fig.align="center", fig.width= 8, fig.cap="The different Resistance of criminals in each Precinct"}
police_force_selected %>% 
  filter(TypeOfResistance %in% (police_force_selected  %>% count(TypeOfResistance) %>% arrange(-n) %>% head(9) %>% pull(TypeOfResistance)),
  Precinct %in% (police_force_selected  %>% count(Precinct) %>% arrange(-n) %>% head(5) %>%  pull(Precinct))) %>% 
    ggplot(aes(TypeOfResistance, fill = Precinct))+
    geom_bar(position = "fill")+
    ggtitle("The Different Type Of Resistance in Each Precinct")+
    scale_colour_gradientn(colours=rainbow(5))+
    coord_flip()
```

Figure \@ref(fig:relationshipfig) shows the relationship between the force type and the type of resistance. This figure captures the effectiveness of the force type used by police. For example, if the only resistance used by police is a police dog, criminals are more likely to flee on foot. However, if a firearm or chemical irritant is used, better results will be achieved.  

```{r relationshipfig, fig.align="center", fig.width= 8, fig.cap="The relationship between Force Type adopted by police and type of resistance of criminals"}

police_force_selected %>% 
  filter(TypeOfResistance %in% (police_force_selected  %>% count(TypeOfResistance) %>% arrange(-n) %>% head(5) %>% pull(TypeOfResistance)),
  ForceType %in% (police_force_selected  %>% count(ForceType) %>% arrange(-n) %>% head(10) %>% pull(ForceType))) %>% 
    ggplot(aes(ForceType, fill = TypeOfResistance))+
    geom_bar(position = "fill")+
    ggtitle("The relationship between force type and type of resistance")+
    scale_fill_ordinal()+
    coord_flip()
```

Figure \@ref(fig:Race) shows the use of force on different races. African Americans are subject to more aggressive forms of force. The figure clearly demonstrates that police are less likely to use less lethal force on African Americans. Looking at this figure alone, it is likely that the treatment of African Americans is unnecessarily barbaric. 

```{r Race, fig.align="center", fig.width= 8, fig.cap="Different races are treated differently"}
police_force_selected %>% 
  filter(Race %in% (police_force_selected  %>% count(Race) %>% arrange(-n) %>% head(3) %>% pull(Race)),
  ForceType %in% (police_force_selected  %>% count(ForceType) %>% arrange(-n)  %>%  pull(ForceType))) %>% 
    ggplot(aes(ForceType, fill = Race))+
    geom_bar(position = "fill")+
    ggtitle("Use of Force Type toward Different Race")+
    scale_colour_gradientn(colours=rainbow(5))+
    coord_flip()
```

## Mapping the Data

```{r neighborhood_racial_composition_table, include = FALSE}
# ----------- Summary Table across all areas
demographics_raw <- read_csv(here::here("data/minneapolis_demographics/profile_download_file_msp_neighborhoods_2014_2018.csv"))

demographics <- demographics_raw %>%
  filter(City == "Minneapolis") %>% 
  select(Neighborhood, `Total population`, 62:97) %>% 
  select(-contains("Margin")) # de select rows containing margin of error

demographics <- janitor::clean_names(demographics) # clean demographics column names 

# show % of racial composition in Minneapolis demographics
demographics_table <- demographics %>% 
  select(2, 3, 7, 9, 11, 13, 15, 17, 19) %>% 
  pivot_longer(cols = 1:9,
               names_to = "Race",
               values_to = "Counts") %>%  # neighbourhood counts
  group_by(Race) %>% 
  summarise(share = sum(Counts)) %>% 
  mutate(share = share/349260) %>% # share/total population
  arrange(share)

share_of_pop = demographics_table %>% filter(Race == "black_or_african_american")
```

```{r puof_table}
# no. of blacks; subject; to puof
puof_black <- police_use_of_force %>% 
  filter(Race == "Black") %>% 
  summarize(count = n())
# total
puof_total <- police_use_of_force %>% 
  count() 
# share of blacks; subject to puof
share_of_puof = puof_black/puof_total

# put into table
puof_table <- as.tibble(c(Race = "Black",
              share_of_puof = share_of_puof)) 
```

```{r ps-total}
# no. of blacks subject to police stop
ps_black <- police_stop_data %>% 
  filter(race %in% c("Black", "East African")) %>% 
  count()

# total
ps_total <- police_stop_data %>% 
  count()

# share of blacks; subject to police stop
share_of_ps = ps_black/ps_total
```

```{r summarytable}
categories <- c("Minneapolis Population", "Police Use of Force", "Police Stop")

share_of_black_categories <- c(share_of_pop$share, share_of_puof$count, share_of_ps$n)

summary_table <- tibble(categories = categories,
                        share = share_of_black_categories)

summary_table %>% 
  kable(caption = "Proportion of African Americans for each Category",
        digits = 2) %>% 
  kable_styling(bootstrap_options = c("striped", "hover"))

# summary_table %>% 
#   ggplot() +
#   geom_bar(mapping = aes(x = share,
#                          y = ..prop..,
#                          group = 1),
#            stat = "identity")
```

African Americans count for 20% of the total population in Minneapolis, @mncompass. However, they are most likely to be stopped by police and the subject of police force as in table \@ref(tab:summarytable). Note that all proportions are subject to a 5% or less margin of error.

```{r read-shp-file, include = FALSE, message = FALSE, warning = FALSE}
# ----------- Police use of force
# read shp file
puof_shp <- rgdal::readOGR(dsn = file.path(paste(getwd(),"/data/Police_Use_of_Force-shp", sep=""), layer = "Police_Use_of_Force.shp") , stringsAsFactors = FALSE)
```

```{r puof-sf, include = FALSE, message = FALSE, warning = FALSE}
library(sf)
# Read shp file into a data frame
puof_sf <- st_read(dsn = file.path(paste(getwd(),"/data/Police_Use_of_Force-shp/Police_Use_of_Force.shp", sep=""))) %>% 
  filter(CenterLati != 0) %>% 
  filter(!(Race %in% c("not recorded", "Unknown")))
```

```{r neighborhood-shp, include = FALSE, message = FALSE, warning = FALSE}
# --------- Neighbourhood data
# read in shape files
neighborhood_shp <- 
  rgdal::readOGR(dsn = file.path(paste(getwd(),"/data/Minneapolis_Neighborhoods-shp", sep=""), layer = "Minneapolis_Neighborhoods.shp") , stringsAsFactors = FALSE)
```

```{r neighborhood-sf, include = FALSE, message = FALSE, warning = FALSE}
# Read in shp file into a data frame
neighborhood_sf <- st_read(dsn = file.path(paste(getwd(),"/data/Minneapolis_Neighborhoods-shp/Minneapolis_Neighborhoods.shp", sep="")))
```

```{r black-share}
# demographics data and neighbourhood shape file data have different neighbourhood area due to some areas (e.g. rivers or industrial area; not inhabited)
## shp file more broken up// demographics data; in neighbourhood area less broken up 
black_share <- demographics %>% 
  select(neighborhood, total_population, black_or_african_american,
         black_or_african_american_share)


black_share <- black_share %>% 
  separate(col = black_or_african_american_share,
           c("black_or_african_american_share", "percent"),
           sep = "%") %>% 
  select(-5) # remove % from character string 

black_share$black_or_african_american_share <- as.numeric(black_share$black_or_african_american_share) # change character string to numeric

library(viridis)
black_composition <-
  left_join(neighborhood_sf, black_share, by = c("BDNAME" = "neighborhood" ))

puof_sf1 <- puof_sf %>% 
  mutate(Race = case_when(
    str_detect(Race, "Black") ~ "Black",
    str_detect(Race, "White") ~ "White",
    str_detect(Race, "Asian") ~ "Others",
    str_detect(Race, "Native American") ~ "Others",
    str_detect(Race, "Other / Mixed Race") ~ "Others",
    str_detect(Race, "Pacific Islander") ~ "Others"
  ))
```

```{r puofmap, fig.cap = "Police use of force data on a Minneapolis Map",  fig.width = 9}
ggplot() +
  geom_sf(data = black_composition,
          aes(fill = black_or_african_american_share)) +
  scale_fill_distiller(type = "seq", 
                       palette = "YIGn",
                       direction = 1,
                       na.value = "light grey",
                       limits = c(0, 53.1)) +
  geom_sf(data = puof_sf1,
          shape = 1,
          alpha = 0.4,
          aes(colour = Race,
              group = Neighborho)) +
  scale_colour_viridis(discrete = TRUE)
```

Figure \@ref(fig:puofmap) shows Minneapolis, segmented by neighbourhoods. The shade of green represents the number of African Americans in each neighbourhood; with dark green indicating a higher proportion of African Americans. Each circle represents an incident where police used force, and the color represents the ethnicity of the subject. Minority groups were classed as 'others'. 

There's a high concentration of African Americans living in the north-west and centre of Minneapolis. These areas also have a high number of incidents where police have used force against African Americans. 

```{r ps-shp, include = FALSE}
# ----------- Police use of force
# read shp file
ps_shp <- rgdal::readOGR(dsn = file.path(paste(getwd(),"/data/Police_Stop_Data-shp", sep=""), layer = "Police_Stop_Data.shp") , stringsAsFactors = FALSE)
```

```{r ps-sf, include = FALSE}
library(sf)
# Read shp file into a data frame
ps_sf <- st_read(dsn = file.path(paste(getwd(),"/data/Police_Stop_Data-shp/Police_Stop_Data.shp", sep=""))) %>% 
  filter(!(race %in% c("Unknown"))) %>% 
  filter(!is.na(race)) %>% 
  filter(lat != 0) 
```

```{r psbar, fig.cap = "Counts per Race in each reason to stop a Vehicle"}
police_stop_data %>% 
  filter(!(problem %in% c("Attempt Pick-Up (P)", "Curfew Violations (P)", "Truancy (P)"))) %>% 
  ggplot() +
  geom_bar(aes(x = race,
               fill = race)) +
  facet_wrap(~problem) +
  coord_flip()
```

Figure \@ref(fig:psbar) shows the number of cars stopped for a given reason, according to race. African Americans were the most likely to be stopped for all reasons. 

```{r ps-sf-1}
ps_sf1 <- ps_sf %>% 
  mutate(race = case_when(
    str_detect(race, "Black") ~ "Black",
    str_detect(race, "East African") ~ "Black",
    str_detect(race, "White") ~ "White",
    str_detect(race, "Asian") ~ "Others",
    str_detect(race, "Latino") ~ "Others",
    str_detect(race, "Other") ~ "Others",
    str_detect(race, "Native American") ~ "Others"
  ))
```

```{r psmap, cache = TRUE, out.width="400%", fig.cap = "Police Stop data on Minneapolis map"}
ggplot() +
  geom_sf(data = black_composition,
          aes(fill = black_or_african_american_share)) +
  scale_fill_distiller(type = "seq", 
                       palette = "YIGn",
                       direction = 1,
                       na.value = "light grey",
                       limits = c(0, 53.1)) +
  geom_sf(data = ps_sf1,
          shape = 1,
          alpha = 0.4,
          aes(colour = race,
              group = neighborho)) +
  scale_colour_viridis(discrete = TRUE)
```

A similar pattern to Figure \@ref(fig:puofmap) was observed in Figure \@ref(fig:psmap). Police stops are highly concentrated in the north western and central areas of Minneapolis, where African American communities are highly represented.

# Conclusion

Theft is the most commonly committed crime in Minneapolis. Downtown West and Whittier are the neighborhoods with the highest crime rate. Interestingly enough, the crime rate tends to be lower in the colder months of the year, and has been lower in 2020 due to the stay at home orders resulting from COVID-19. The crime rate is higher during the week, while the force use is much higher on weekends; indicating a greater police presence on weekends. 

Analysis of the use of force dashboard revealed that police dogs are generally ineffective in arrests as criminals are more likely to flee on foot. The use of force towards African Americans is significantly higher for all force types, except the less lethal force type. This is disproportionate to the number of African Americans in Minneapolis. Additionally, the incidence of force use on African Americans and the number of African Americans stopped is much higher in communities where African Americans are highly represented. Unfortunately, the analysis has divulged clear patterns of discrimination which is deeply distressing and calls for immediate action.  

\clearpage